"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[296],{1298:(e,a,d)=>{d.d(a,{A:()=>s});let s=(0,d(3508).A)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},2073:(e,a,d)=>{d.d(a,{A:()=>s});let s=(0,d(3508).A)("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},3802:(e,a,d)=>{d.d(a,{sG:()=>n});var s=d(2223);d(9507);var i=d(228),l=d(1503),n=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,a)=>{let d=(0,i.TL)(`Primitive.${a}`),n=s.forwardRef((e,s)=>{let{asChild:i,...n}=e;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,l.jsx)(i?d:a,{...n,ref:s})});return n.displayName=`Primitive.${a}`,{...e,[a]:n}},{})},4684:(e,a,d)=>{d.d(a,{A:()=>s});let s=(0,d(3508).A)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},5363:(e,a,d)=>{d.d(a,{b:()=>r});var s=d(2223),i=d(3802),l=d(1503),n=s.forwardRef((e,a)=>(0,l.jsx)(i.sG.label,{...e,ref:a,onMouseDown:a=>{a.target.closest("button, input, select, textarea")||(e.onMouseDown?.(a),!a.defaultPrevented&&a.detail>1&&a.preventDefault())}}));n.displayName="Label";var r=n},5582:(e,a,d)=>{d.d(a,{A:()=>h});var s=d(1503),i=d(2223),l=d(2431),n=d(5293),r=d(3679),o=d(4577),t=d(1298),c=d(5785),u=d(4684),m=d(5949),v=d(3572);function h(e){let{venda:a,onSubmit:d,onCancel:h,loading:p=!1}=e,[x,j]=(0,i.useState)({cliente_id:(null==a?void 0:a.cliente_id)||"",vendedor_id:(null==a?void 0:a.vendedor_id)||"",forma_pagamento:(null==a?void 0:a.forma_pagamento)||"dinheiro",origem_venda:(null==a?void 0:a.origem_venda)||"loja_fisica",observacoes:(null==a?void 0:a.observacoes)||"",desconto:(null==a?void 0:a.desconto)||0}),[g,_]=(0,i.useState)([]),[b,f]=(0,i.useState)([]),[N,y]=(0,i.useState)([]),[w,A]=(0,i.useState)([]),[C,k]=(0,i.useState)(!1);(0,i.useEffect)(()=>{S()},[]);let S=async()=>{try{k(!0);let[e,a,d]=await Promise.all([v.pK.getAll(1,100),v.Rg.getAll(1,100),v.Aw.getAll(1,100)]);e.success&&e.data&&f(e.data),a.success&&a.data&&y(a.data),d.success&&d.data&&A(d.data)}catch(e){}finally{k(!1)}},M=(e,a,d)=>{let s=[...g];if(s[e]={...s[e],[a]:d},"produto_id"===a){let a=w.find(e=>e.id===d);a&&(s[e].produto_nome=a.nome,s[e].preco_unitario=a.preco_venda,s[e].subtotal=s[e].quantidade*a.preco_venda)}else("quantidade"===a||"preco_unitario"===a)&&(s[e].subtotal=s[e].quantidade*s[e].preco_unitario);_(s)};return C?(0,s.jsx)(o.Zp,{className:"w-full max-w-4xl mx-auto",children:(0,s.jsxs)(o.Wu,{className:"flex items-center justify-center py-8",children:[(0,s.jsx)(t.A,{className:"h-8 w-8 animate-spin"}),(0,s.jsx)("span",{className:"ml-2",children:"Carregando dados..."})]})}):(0,s.jsxs)(o.Zp,{className:"w-full max-w-4xl mx-auto",children:[(0,s.jsx)(o.aR,{children:(0,s.jsxs)(o.ZB,{className:"flex items-center",children:[(0,s.jsx)(c.A,{className:"mr-2 h-5 w-5"}),a?"Editar Venda":"Nova Venda"]})}),(0,s.jsx)(o.Wu,{children:(0,s.jsxs)("form",{onSubmit:e=>{if(e.preventDefault(),0===g.length)return void alert("Adicione pelo menos um item \xe0 venda");d({...x,cliente_id:x.cliente_id?Number(x.cliente_id):null,vendedor_id:x.vendedor_id?Number(x.vendedor_id):null,itens:g.map(e=>({produto_id:e.produto_id,quantidade:e.quantidade,preco_unitario:e.preco_unitario}))})},className:"space-y-6",children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(r.J,{htmlFor:"cliente_id",children:"Cliente"}),(0,s.jsxs)("select",{id:"cliente_id",value:x.cliente_id,onChange:e=>j(a=>({...a,cliente_id:e.target.value})),className:"w-full p-2 border rounded-md",children:[(0,s.jsx)("option",{value:"",children:"Selecione um cliente"}),b.map(e=>(0,s.jsx)("option",{value:e.id,children:e.nome},e.id))]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(r.J,{htmlFor:"vendedor_id",children:"Vendedor"}),(0,s.jsxs)("select",{id:"vendedor_id",value:x.vendedor_id,onChange:e=>j(a=>({...a,vendedor_id:e.target.value})),className:"w-full p-2 border rounded-md",children:[(0,s.jsx)("option",{value:"",children:"Selecione um vendedor"}),N.map(e=>(0,s.jsx)("option",{value:e.id,children:e.nome},e.id))]})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(r.J,{htmlFor:"forma_pagamento",children:"Forma de Pagamento"}),(0,s.jsxs)("select",{id:"forma_pagamento",value:x.forma_pagamento,onChange:e=>j(a=>({...a,forma_pagamento:e.target.value})),className:"w-full p-2 border rounded-md",children:[(0,s.jsx)("option",{value:"dinheiro",children:"Dinheiro"}),(0,s.jsx)("option",{value:"cartao",children:"Cart\xe3o"}),(0,s.jsx)("option",{value:"pix",children:"PIX"}),(0,s.jsx)("option",{value:"transferencia",children:"Transfer\xeancia"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(r.J,{htmlFor:"origem_venda",children:"Origem da Venda"}),(0,s.jsxs)("select",{id:"origem_venda",value:x.origem_venda,onChange:e=>j(a=>({...a,origem_venda:e.target.value})),className:"w-full p-2 border rounded-md",children:[(0,s.jsx)("option",{value:"loja_fisica",children:"Loja F\xedsica"}),(0,s.jsx)("option",{value:"mercado_livre",children:"Mercado Livre"}),(0,s.jsx)("option",{value:"shopee",children:"Shopee"}),(0,s.jsx)("option",{value:"magazine_luiza",children:"Magazine Luiza"}),(0,s.jsx)("option",{value:"americanas",children:"Americanas"}),(0,s.jsx)("option",{value:"outros",children:"Outros"})]})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,s.jsx)(r.J,{children:"Itens da Venda"}),(0,s.jsxs)(l.$,{type:"button",onClick:()=>{_([...g,{produto_id:0,produto_nome:"",quantidade:1,preco_unitario:0,subtotal:0}])},size:"sm",children:[(0,s.jsx)(u.A,{className:"mr-2 h-4 w-4"}),"Adicionar Item"]})]}),(0,s.jsx)("div",{className:"space-y-3",children:g.map((e,a)=>(0,s.jsxs)("div",{className:"grid grid-cols-12 gap-2 items-end",children:[(0,s.jsxs)("div",{className:"col-span-5",children:[(0,s.jsx)(r.J,{children:"Produto"}),(0,s.jsxs)("select",{value:e.produto_id,onChange:e=>M(a,"produto_id",Number(e.target.value)),className:"w-full p-2 border rounded-md",children:[(0,s.jsx)("option",{value:0,children:"Selecione um produto"}),w.map(e=>(0,s.jsxs)("option",{value:e.id,children:[e.nome," - R$ ",e.preco_venda.toFixed(2)]},e.id))]})]}),(0,s.jsxs)("div",{className:"col-span-2",children:[(0,s.jsx)(r.J,{children:"Qtd"}),(0,s.jsx)(n.p,{type:"number",min:"1",value:e.quantidade,onChange:e=>M(a,"quantidade",Number(e.target.value))})]}),(0,s.jsxs)("div",{className:"col-span-2",children:[(0,s.jsx)(r.J,{children:"Pre\xe7o Unit."}),(0,s.jsx)(n.p,{type:"number",step:"0.01",value:e.preco_unitario,onChange:e=>M(a,"preco_unitario",Number(e.target.value))})]}),(0,s.jsxs)("div",{className:"col-span-2",children:[(0,s.jsx)(r.J,{children:"Subtotal"}),(0,s.jsx)(n.p,{type:"text",value:"R$ ".concat(e.subtotal.toFixed(2)),readOnly:!0,className:"bg-gray-50"})]}),(0,s.jsx)("div",{className:"col-span-1",children:(0,s.jsx)(l.$,{type:"button",onClick:()=>{_(g.filter((e,d)=>d!==a))},size:"sm",variant:"ghost",className:"text-red-600",children:(0,s.jsx)(m.A,{className:"h-4 w-4"})})})]},a))})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(r.J,{htmlFor:"desconto",children:"Desconto (R$)"}),(0,s.jsx)(n.p,{id:"desconto",type:"number",step:"0.01",value:x.desconto,onChange:e=>j(a=>({...a,desconto:Number(e.target.value)})),placeholder:"0,00"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(r.J,{children:"Total da Venda"}),(0,s.jsx)(n.p,{type:"text",value:"R$ ".concat((g.reduce((e,a)=>e+a.subtotal,0)-(Number(x.desconto)||0)).toFixed(2)),readOnly:!0,className:"bg-gray-50 font-bold text-lg"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(r.J,{htmlFor:"observacoes",children:"Observa\xe7\xf5es"}),(0,s.jsx)("textarea",{id:"observacoes",value:x.observacoes,onChange:e=>j(a=>({...a,observacoes:e.target.value})),placeholder:"Observa\xe7\xf5es adicionais",className:"w-full p-2 border rounded-md h-20 resize-none"})]}),(0,s.jsxs)("div",{className:"flex justify-end space-x-2 pt-4",children:[(0,s.jsx)(l.$,{type:"button",variant:"outline",onClick:h,children:"Cancelar"}),(0,s.jsx)(l.$,{type:"submit",disabled:p||0===g.length,children:p?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Salvando..."]}):"Salvar Venda"})]})]})})]})}},5949:(e,a,d)=>{d.d(a,{A:()=>s});let s=(0,d(3508).A)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]])}}]);